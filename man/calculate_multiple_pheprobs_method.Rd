% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiple_phenotypes_impl.R
\name{calculate_multiple_pheprobs_method}
\alias{calculate_multiple_pheprobs_method}
\title{Calculate Multiple PheProbs using Original Binomial Mixture Models}
\usage{
calculate_multiple_pheprobs_method(
  phenotype_concepts,
  person_ids = NULL,
  domains = c("condition", "procedure", "drug", "measurement", "observation"),
  date_range = NULL,
  output_format = "wide",
  output_file = NULL,
  batch_size = 10000,
  progress = TRUE,
  max_iterations = 1000,
  convergence_threshold = 1e-06,
  init_method = "random",
  exclude_concepts = NULL,
  data_validation = TRUE,
  model_diagnostics = TRUE,
  phenotype_correlation_analysis = TRUE,
  joint_validation = TRUE,
  ...
)
}
\arguments{
\item{phenotype_concepts}{A named list where each element contains the concept IDs
for a specific phenotype}

\item{person_ids}{A numeric vector of person IDs. If NULL, includes all available persons.}

\item{domains}{A character vector specifying which OMOP domains to search}

\item{date_range}{Optional list with 'start' and 'end' dates to limit temporal scope}

\item{output_format}{Character string specifying output format: "wide", "long"}

\item{output_file}{Optional file path to save results}

\item{batch_size}{Integer specifying batch size for processing large datasets}

\item{progress}{Logical indicating whether to show progress bars}

\item{max_iterations}{Maximum EM iterations for each binomial mixture model}

\item{convergence_threshold}{Convergence threshold for EM algorithm}

\item{init_method}{Initialization method for EM: "random", "kmeans", "manual"}

\item{exclude_concepts}{Concept IDs to exclude from total healthcare utilization counts}

\item{data_validation}{Logical indicating whether to perform data quality validation}

\item{model_diagnostics}{Logical indicating whether to include model diagnostics}

\item{phenotype_correlation_analysis}{Logical indicating whether to analyze correlations}

\item{joint_validation}{Logical indicating whether to perform joint validation}

\item{...}{Additional arguments}
}
\value{
A tibble with class "pheprob_multiple" containing multiple phenotype
probabilities and analysis results
}
\description{
Implements multiple phenotype analysis using the PheProb methodology (Sinnott et al., 2018).
Each phenotype gets its own binomial mixture model fitted to (S_k, C) pairs
where S_k is the count of codes relevant to phenotype k and C is total
healthcare utilization.
}
