% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_utils.R
\name{prepare_pheprob_binomial_data}
\alias{prepare_pheprob_binomial_data}
\title{Prepare Data for Original PheProb Binomial Mixture Model}
\usage{
prepare_pheprob_binomial_data(
  concept_ids,
  person_ids = NULL,
  domains = c("condition", "procedure", "drug", "measurement", "observation"),
  date_range = NULL,
  exclude_concepts = NULL,
  max_persons = NULL
)
}
\arguments{
\item{concept_ids}{A numeric vector of disease-relevant OMOP concept IDs}

\item{person_ids}{A numeric vector of person IDs. If NULL, includes all available persons.}

\item{domains}{A character vector specifying which OMOP domains to search.
Default: c("condition", "procedure", "drug", "measurement", "observation")}

\item{date_range}{A list with 'start' and 'end' dates (Date objects) to limit
the temporal scope of data extraction. If NULL, no date filtering is applied.}

\item{exclude_concepts}{Optional vector of concept IDs to exclude from total counts}

\item{max_persons}{Maximum number of persons to process (for testing/limiting).
If NULL, processes all available persons.}
}
\value{
A tibble with columns required for binomial mixture model:
\item{person_id}{Person identifier}
\item{S}{Disease-relevant code count}
\item{C}{Total healthcare code count}
\item{success_rate}{S/C ratio}
\item{first_code_date}{Date of first billing code}
\item{last_code_date}{Date of last billing code}
\item{healthcare_span_days}{Days of healthcare activity}
}
\description{
Extracts and combines total healthcare utilization counts with disease-relevant
code counts to create the (S, C) pairs required for the original PheProb
binomial mixture model.
}
\examples{
\dontrun{
# Prepare data for diabetes phenotyping
diabetes_concepts <- c(201820, 201826, 4193704)
pheprob_data <- prepare_pheprob_binomial_data(diabetes_concepts)

# Check data quality
summary(pheprob_data)
}
}
