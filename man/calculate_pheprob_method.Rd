% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/single_phenotype_impl.R
\name{calculate_pheprob_method}
\alias{calculate_pheprob_method}
\title{Calculate PheProb using Original Binomial Mixture Model}
\usage{
calculate_pheprob_method(
  concept_ids,
  person_ids = NULL,
  domains = c("condition", "procedure", "drug", "measurement", "observation"),
  date_range = NULL,
  output_format = "wide",
  output_file = NULL,
  batch_size = 10000,
  progress = TRUE,
  max_iterations = 1000,
  convergence_threshold = 1e-06,
  init_method = "random",
  exclude_concepts = NULL,
  data_validation = TRUE,
  model_diagnostics = TRUE,
  ...
)
}
\arguments{
\item{concept_ids}{A numeric vector of disease-relevant OMOP concept IDs}

\item{person_ids}{A numeric vector of person IDs. If NULL, includes all available persons.}

\item{domains}{A character vector specifying which OMOP domains to search.}

\item{date_range}{Optional list with 'start' and 'end' dates (Date objects) to limit
the temporal scope of data extraction.}

\item{output_format}{Character string specifying output format: "wide", "long", "matrix"}

\item{output_file}{Optional file path to save results}

\item{batch_size}{Integer specifying batch size for processing large datasets}

\item{progress}{Logical indicating whether to show progress bars}

\item{max_iterations}{Maximum EM iterations for binomial mixture model}

\item{convergence_threshold}{Convergence threshold for EM algorithm}

\item{init_method}{Initialization method for EM: "random", "kmeans", "manual"}

\item{exclude_concepts}{Concept IDs to exclude from total healthcare utilization counts}

\item{data_validation}{Logical indicating whether to perform data quality validation}

\item{model_diagnostics}{Logical indicating whether to include model diagnostics}

\item{...}{Additional arguments}
}
\value{
A tibble with class "pheprob_single" containing phenotype probabilities
and model information
}
\description{
Implements the original PheProb algorithm using a binomial mixture model with
healthcare utilization adjustment. This provides true phenotype probabilities
P(Y=1|S,C) where S is disease-relevant code count and C is total healthcare utilization.
}
