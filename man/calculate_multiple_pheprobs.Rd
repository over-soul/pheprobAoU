% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_pheprob.R
\name{calculate_multiple_pheprobs}
\alias{calculate_multiple_pheprobs}
\title{Calculate Multiple PheProbs}
\usage{
calculate_multiple_pheprobs(
  phenotype_concepts,
  person_ids = NULL,
  domains = c("condition", "procedure", "drug", "measurement", "observation"),
  date_range = NULL,
  output_format = "wide",
  output_file = NULL,
  batch_size = 10000,
  progress = TRUE,
  max_iterations = 1000,
  convergence_threshold = 1e-06,
  init_method = "random",
  exclude_concepts = NULL,
  data_validation = TRUE,
  model_diagnostics = TRUE,
  phenotype_correlation_analysis = TRUE,
  joint_validation = TRUE,
  ...
)
}
\arguments{
\item{phenotype_concepts}{A named list where each element contains concept IDs
for a specific phenotype. Names will be used as column names in the output.}

\item{person_ids}{A numeric vector of person IDs to include in the analysis.
If NULL (default), includes all available persons in the database.}

\item{domains}{Character vector specifying which OMOP domains to search.
Default: c("condition", "procedure", "drug", "measurement", "observation")}

\item{date_range}{Optional list with 'start' and 'end' dates (Date objects)
to limit the temporal scope of data extraction.}

\item{output_format}{Character string specifying output format:
\itemize{
\item "wide": Returns wide-format tibble with separate columns per phenotype (default)
\item "long": Returns long-format tibble with phenotype_name column
}}

\item{output_file}{Optional file path to save results.}

\item{batch_size}{Integer specifying batch size for processing large datasets}

\item{progress}{Logical indicating whether to show progress bars (default: TRUE)}

\item{max_iterations}{Maximum EM iterations for binomial mixture model}

\item{convergence_threshold}{Convergence threshold for EM algorithm}

\item{init_method}{Initialization method for EM: "random", "kmeans", "manual"}

\item{exclude_concepts}{Concept IDs to exclude from total healthcare utilization counts}

\item{data_validation}{Logical indicating whether to perform data quality validation}

\item{model_diagnostics}{Logical indicating whether to include model diagnostics}

\item{phenotype_correlation_analysis}{Logical indicating whether to analyze correlations}

\item{joint_validation}{Logical indicating whether to perform joint validation}

\item{...}{Additional arguments}
}
\value{
Depending on output_format:
\item{wide}{Tibble with person_id and one probability column per phenotype}
\item{long}{Tibble with person_id, phenotype_name, pheprob_score columns}
}
\description{
Calculates separate PheProb scores for multiple related phenotypes using
binomial mixture models. Each phenotype gets its own probability score.
}
\examples{
\dontrun{
# Define multiple phenotypes
phenotypes <- list(
  diabetes = c(201826, 4329847, 9201),
  cvd = c(314866, 313217, 316866),
  depression = c(4152280, 4226263)
)

# Calculate separate probabilities for each phenotype
multi_scores <- calculate_multiple_pheprobs(
  phenotype_concepts = phenotypes
)
}
}
